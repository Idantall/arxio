(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{156:function(e,s,a){Promise.resolve().then(a.bind(a,9093)),Promise.resolve().then(a.t.bind(a,7929,23))},9093:function(e,s,a){"use strict";a.r(s),a.d(s,{LoginForm:function(){return U}});var r,t,i,n=a(6911),l=a(3761),o=a(5319),d=a(63),m=a(5232),c=a(2473),u=((r=u||{}).SAST="SAST",r.DAST="DAST",r),p=((t=p||{}).QUEUED="QUEUED",t.RUNNING="RUNNING",t.SUCCESS="SUCCESS",t.ERROR="ERROR",t),g=((i=g||{}).CRITICAL="CRITICAL",i.HIGH="HIGH",i.MEDIUM="MEDIUM",i.LOW="LOW",i.INFO="INFO",i),x=c.z.object({email:c.z.string().email({message:"כתובת אימייל לא תקינה"}),password:c.z.string().min(8,{message:"סיסמה חייבת להיות באורך 8 תווים לפחות"}).max(100).regex(/[A-Z]/,{message:"סיסמה חייבת לכלול אות גדולה"}).regex(/[a-z]/,{message:"סיסמה חייבת לכלול אות קטנה"}).regex(/[0-9]/,{message:"סיסמה חייבת לכלול ספרה"})});x.extend({name:c.z.string().min(2,{message:"שם חייב להיות באורך 2 תווים לפחות"})}),c.z.object({id:c.z.string().optional(),repoProvider:c.z.enum(["github","gitlab","bitbucket"]),repoOwner:c.z.string().min(1,{message:"שם הבעלים נדרש"}),repoName:c.z.string().min(1,{message:"שם המאגר נדרש"}),defaultBranch:c.z.string().default("main"),deployedUrl:c.z.string().url({message:"כתובת URL לא תקינה"}).optional()}),c.z.object({projectId:c.z.string(),scanType:c.z.nativeEnum(u)}),c.z.object({id:c.z.string().optional(),scanId:c.z.string().optional(),severity:c.z.nativeEnum(g),ruleId:c.z.string(),title:c.z.string(),description:c.z.string(),filePath:c.z.string().optional(),lineStart:c.z.number().optional(),lineEnd:c.z.number().optional(),url:c.z.string().optional(),resolved:c.z.boolean().default(!1)});var h=a(2548),b=a(39),f=a.n(b),w=a(7606),N=a(2113),j=a(6580);let v=[{id:"1",name:"Demo User",email:"demo@example.com",image:null,passwordHash:"demo123"}],z={session:{strategy:"jwt"},pages:{signIn:"/auth/login",signOut:"/auth/logout",error:"/auth/error"},providers:[(0,N.Z)({clientId:j.env.GITHUB_CLIENT_ID||"",clientSecret:j.env.GITHUB_CLIENT_SECRET||""}),(0,w.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){let s=x.safeParse(e);if(!s.success)return null;let{email:a,password:r}=s.data,t=v.find(e=>e.email===a);return t&&t.passwordHash&&(t.passwordHash===r||"demo123"===r)?{id:t.id,name:t.name,email:t.email,image:t.image}:null}})],callbacks:{async session(e){let{session:s,token:a}=e;return a.sub&&s.user&&(s.user.id=a.sub),s},async jwt(e){let{token:s}=e;return s}}},{handlers:I,auth:y,signIn:E,signOut:S}=f()(z);var C=a(1552);function U(){let e=(0,o.useRouter)(),[s,a]=(0,l.useState)(null),[r,t]=(0,l.useState)(!1),[i,c]=(0,l.useState)(!1),{register:u,handleSubmit:p,formState:{errors:g}}=(0,d.cI)({resolver:(0,m.F)(x),defaultValues:{email:"",password:""}});async function b(s){t(!0),a(null);try{let r=await E("credentials",{email:s.email.toLowerCase(),password:s.password,redirect:!1});if(!(null==r?void 0:r.ok)){a("Invalid email or password");return}e.refresh(),e.push("/dashboard")}catch(e){a("An error occurred. Please try again.")}finally{t(!1)}}let f=async()=>{c(!0);try{await (0,C.signIn)("github",{callbackUrl:"/dashboard"})}catch(e){console.error("GitHub login error:",e),a("אירעה שגיאה בעת ניסיון ההתחברות דרך GitHub")}finally{c(!1)}};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsx)("form",{onSubmit:p(b),children:(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,n.jsx)("input",{id:"email",type:"email",autoCapitalize:"none",autoComplete:"email",autoCorrect:"off",disabled:r,className:"border rounded-md p-2",...u("email")}),g.email&&(0,n.jsx)("p",{className:"text-sm text-red-500",children:g.email.message})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),(0,n.jsx)("a",{href:"/auth/forgot-password",className:"text-sm text-primary underline-offset-4 hover:underline",children:"Forgot password?"})]}),(0,n.jsx)("input",{id:"password",type:"password",autoComplete:"current-password",disabled:r,className:"border rounded-md p-2",...u("password")}),g.password&&(0,n.jsx)("p",{className:"text-sm text-red-500",children:g.password.message})]}),s&&(0,n.jsx)("p",{className:"text-sm text-red-500",children:s}),(0,n.jsx)(h.zx,{type:"submit",disabled:r,className:"w-full",children:r?"Signing in...":"Sign in"})]})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,n.jsx)("span",{className:"w-full border-t"})}),(0,n.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,n.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"התחברות עם"})})]}),(0,n.jsxs)(h.zx,{variant:"outline",type:"button",disabled:i,onClick:f,className:"w-full flex items-center justify-center",children:[i?(0,n.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,n.jsx)("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),i?"מתחבר...":"התחברות באמצעות GitHub"]})]})})}}},function(e){e.O(0,[997,912,79,929,552,773,548,200,533,744],function(){return e(e.s=156)}),_N_E=e.O()}]);