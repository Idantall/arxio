(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{9378:function(e,s,t){Promise.resolve().then(t.bind(t,5923))},5923:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(6911),c=t(3761),l=t(5319),r=t(2548),i=t(3781),n=t(208),d=t(9197),o=t(5189),m=t(9870),x=t(178),h=t(3180),u=t(8620),j=t(1601);function p(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),[t,p]=(0,c.useState)(null),[f,N]=(0,c.useState)([]),[v,y]=(0,c.useState)(null),[w,b]=(0,c.useState)(""),[g,k]=(0,c.useState)(!0),[Z,C]=(0,c.useState)(!1),[O,S]=(0,c.useState)(null);(0,c.useEffect)(()=>{let t=async()=>{try{let s=await fetch("/api/projects/".concat(e.id,"/scans"));if(s.ok){let e=await s.json();N(e)}}catch(e){console.error("שגיאה בטעינת תוצאות סריקה:",e)}};(async()=>{try{let s=await fetch("/api/projects/".concat(e.id));if(!s.ok)throw Error("פרויקט לא נמצא");let t=await s.json();p(t)}catch(e){console.error("שגיאה בטעינת פרויקט:",e),s.push("/dashboard")}finally{k(!1)}})(),t()},[e.id,s]);let E=async()=>{C(!0),S(null);try{let s=await fetch("/api/projects/".concat(e.id,"/scan"),{method:"POST"});if(!s.ok){let e=await s.json();throw Error(e.message||"שגיאה בהתחלת הסריקה")}}catch(e){console.error("שגיאה בהתחלת סריקה:",e),S(e instanceof Error?e.message:"שגיאה לא צפויה אירעה"),C(!1)}},_=async()=>{try{await fetch("/api/projects/".concat(e.id,"/scan/stop"),{method:"POST"}),C(!1)}catch(e){console.error("שגיאה בעצירת סריקה:",e)}},z=async s=>{try{let t=await fetch("/api/projects/".concat(e.id,"/file?path=").concat(encodeURIComponent(s)));if(!t.ok)throw Error("לא ניתן לטעון את תוכן הקובץ");let a=await t.json();b(a.content)}catch(e){console.error("שגיאה בטעינת תוכן הקובץ:",e),b("// שגיאה בטעינת תוכן הקובץ")}},L=e=>{y(e),z(e.file)};return g?(0,a.jsxs)("div",{className:"container mx-auto p-8",children:[(0,a.jsx)(r.Od,{className:"h-12 w-1/3 mb-4"}),(0,a.jsx)(r.Od,{className:"h-6 w-1/2 mb-8"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(r.Od,{className:"h-40"}),(0,a.jsx)(r.Od,{className:"h-40 md:col-span-2"})]})]}):t?(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:t.name}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:t.description||"אין תיאור"}),(0,a.jsxs)("div",{className:"flex mt-2 space-x-2",children:[t.repositoryType&&(0,a.jsxs)(r.Ct,{variant:"outline",className:"flex items-center space-x-1",children:[(0,a.jsx)(n.Z,{className:"h-3.5 w-3.5 ml-1"}),(0,a.jsx)("span",{children:t.repositoryType})]}),t.branch&&(0,a.jsxs)(r.Ct,{variant:"outline",className:"flex items-center space-x-1",children:[(0,a.jsx)(d.Z,{className:"h-3.5 w-3.5 ml-1"}),(0,a.jsx)("span",{children:t.branch})]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-4 md:mt-0",children:[Z?(0,a.jsxs)(r.zx,{variant:"destructive",onClick:_,children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 ml-2"}),"עצור סריקה"]}):(0,a.jsxs)(r.zx,{onClick:E,children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 ml-2"}),"התחל סריקה"]}),(0,a.jsxs)(r.zx,{variant:"outline",onClick:()=>s.push("/project/".concat(t.id,"/settings")),children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 ml-2"}),"הגדרות"]})]})]}),O&&(0,a.jsxs)("div",{className:"flex items-center p-3 text-sm bg-destructive/15 text-destructive rounded-md mb-6",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5 ml-2 shrink-0"}),(0,a.jsx)("p",{children:O})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(r.Zb,{className:"md:col-span-1",children:[(0,a.jsxs)(r.Ol,{children:[(0,a.jsx)(r.ll,{children:"תוצאות סריקה"}),(0,a.jsxs)(r.SZ,{children:[f.length," ממצאים נמצאו"]})]}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("div",{className:"h-[calc(100vh-20rem)] overflow-y-auto space-y-2 p-1",children:0===f.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(h.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),(0,a.jsx)("p",{children:"אין ממצאים"}),(0,a.jsx)("p",{className:"text-sm",children:"התחל סריקה כדי לאתר חולשות בפרויקט"})]}):f.map(e=>(0,a.jsxs)("div",{className:"border rounded-md p-3 cursor-pointer transition-colors ".concat((null==v?void 0:v.id)===e.id?"bg-primary/10 border-primary/50":"hover:bg-muted"),onClick:()=>L(e),children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)(r.Ct,{variant:"critical"===e.severity?"destructive":"high"===e.severity?"destructive":"medium"===e.severity?"warning":"outline",children:"critical"===e.severity?"קריטי":"high"===e.severity?"גבוה":"medium"===e.severity?"בינוני":"נמוך"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.line,":",e.column]})]}),(0,a.jsxs)("div",{className:"flex items-start mt-1",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mt-0.5 ml-2 shrink-0 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"truncate text-sm font-medium",children:e.file.split("/").pop()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground truncate",dir:"ltr",children:e.file})]})]}),(0,a.jsx)("p",{className:"mt-1 text-sm",children:e.message})]},e.id))})})]}),(0,a.jsxs)(r.Zb,{className:"md:col-span-2",children:[(0,a.jsx)(r.Ol,{className:"pb-2",children:(0,a.jsx)(r.ll,{children:v?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 ml-2"}),(0,a.jsx)("span",{dir:"ltr",children:v.file})]}):"צפייה בקוד"})}),(0,a.jsx)(r.aY,{children:(0,a.jsx)("div",{className:"border rounded-md overflow-hidden h-[calc(100vh-16rem)]",children:v?(0,a.jsx)(j.ML,{height:"100%",language:"javascript",theme:"vs-dark",value:w,options:{readOnly:!0,minimap:{enabled:!0},lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0}}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[(0,a.jsx)(h.Z,{className:"h-16 w-16 mb-4 opacity-20"}),(0,a.jsx)("p",{children:"בחר ממצא מהרשימה כדי לצפות בקוד"})]})})})]})]})]}):(0,a.jsxs)("div",{className:"container mx-auto p-8 text-center",children:[(0,a.jsx)(i.Z,{className:"h-16 w-16 mx-auto mb-4 text-destructive"}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"פרויקט לא נמצא"}),(0,a.jsx)("p",{className:"mb-6",children:"הפרויקט המבוקש אינו קיים או שאין לך הרשאות לצפות בו"}),(0,a.jsx)(r.zx,{onClick:()=>s.push("/dashboard"),children:"חזרה ללוח הבקרה"})]})}}},function(e){e.O(0,[912,375,158,200,533,744],function(){return e(e.s=9378)}),_N_E=e.O()}]);